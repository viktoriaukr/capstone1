{% extends "base.html" %} {% block content %}
<div class="container mt-5 d-flex align-items-center">
  <div class="row row-cols-md-2 g-5">
    <div class="card mb-3" style="width: 13rem; height: 25rem">
      <div class="col">
        <img
          src="http://covers.openlibrary.org/b/id/{{ book.book.covers[0] }}-M.jpg"
          alt="{{ book.title }}"
          class="card-img-top mt-2 rounded"
        />
        <div class="card-body">
          <form method="POST" style="width: 8rem">
            {{ form.hidden_tag() }} {% for field in form if
            field.widget.input_type != 'hidden' %} {% for error in field.errors
            %}
            <span class="text-danger">{{ error }}</span>
            {% endfor %} {{ field(placeholder=field.label.text,
            class="form-control") }} {% endfor %}
            <button class="btn btn-primary btn-block" style="width: 8rem">
              Add to list
            </button>
          </form>
        </div>
      </div>
    </div>
    <div class="col-10" style="width: 60rem">
      <h1>{{title| replace("_", " ")}}</h1>
      <h5>
        by
        <a href="{{url_for('authors', key=author.key)}}"
          ><span>{{author.name}}</span></a
        >
      </h5>
      <p>
        <i
          class="fa-sharp fa-solid fa-star fa-flip fa-lg"
          style="color: #ffdd00"
        ></i>
        {{rating.summary.average|round(2)}}
      </p>
      {% if book.description.value %}
      <p>{{book.description.value}}</p>
      {% else %}
      <p>{{book.description}}</p>
      {% endif %}
      <p>Genres: <i>{{book.subjects|join(', ')}}</i></p>
    </div>
  </div>
</div>
<div class="row justify-content-md-start">
  <div class="col-md-7 col-lg-5">
    <h2 class="join-message">Comments & Reviews</h2>
    <form method="POST">
      {{ form2.hidden_tag() }} {% for field in form2 if field.widget.input_type
      != 'hidden' %} {% for error in field.errors %}
      <span class="text-danger">{{ error }}</span>
      {% endfor %} {{ field(placeholder=field.label.text, class="form-control")
      }} {% endfor %}

      <button class="btn btn-primary btn-lg btn-block">Add comment</button>
    </form>
  </div>
</div>

<hr />
{% for review in reviews %}
<p>{{review.user.first_name}} {{review.user.last_name}}</p>
<p>{{review.text}}</p>
<div class="message-area" name="review">
  <form
    method="POST"
    action='{{url_for("edit_review", key=book.key, title=book.title|replace(" ", "_"))}}'
  >
    <button class="btn btn-success">Edit</button>
  </form>
  <form
    method="POST"
    action="{{url_for('destroy_review',key=book.key, title=book.title|replace(' ', '_'))}}"
  >
    <button class="btn btn-outline-danger">Delete</button>
  </form>
  <span class="text-muted">{{review.timestamp.strftime('%d %B %Y')}}</span>
  <hr />
</div>
{% endfor %} {% endblock %}
